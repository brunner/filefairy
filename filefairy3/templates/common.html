{% macro alert(icon, text) -%}
<div class="row">
  <div class="col-12">
    <div class="alert alert-secondary mt-3 mb-0">
      <span class="oi oi-{{ icon }} text-secondary"></span>{{ text }}
    </div>
  </div>
</div>
{%- endmacro -%}

{% macro card(data) -%}
<div class="card d-flex flex-column flex-grow mt-3">
  <div class="card-body d-flex flex-column">
    <h5 class="card-title">
      {% if data.href %}
      <a href="{{ data.href }}">{{ data.title }}</a>
      {% else %}
      {{ data.title }}
      {% endif %}
    </h5>
    {% if data.info %}
    <p class="card-text flex-grow">{{ data.info }}</p>
    {% endif %}
    {% if data.table %}
    {{ table(data.table)|indent(4) }}
    {% endif %}
  </div>
  {% if data.ts %}
  <div class="card-footer text-muted text-truncate">
    <small>Last activity: {{ data.ts }}
      {%- if data.success -%}
      <span class="text-success"> ({{ data.success }})</span>
      {%- elif data.danger -%}
      <span class="text-danger"> ({{ data.danger }})</span>
      {%- endif -%}
    </small>
  </div>
  {% endif %}
</div>
{%- endmacro -%}

{% macro table(data) -%}

{%- set col_class = [] -%}
{%- for col in data.cols -%}
{%- set c = ' class="' + col + '"' if col else '' -%}
{%- do col_class.append(c) -%}
{%- endfor -%}

<table class="table {{ data.clazz }}">
  {% if data.head %}
  <thead class="thead-light">
    <tr>
      {% for cell in data.head %}
      <td scope="col"{{ col_class[loop.index0] | safe }}>{{ cell }}</td>
      {% endfor %}
    </tr>
  </thead>
  {% endif %}
  {% if data.body %}
  <tbody>
    {% for row in data.body %}
    <tr>
      {% for cell in row %}
      {% if loop.first %}
      <td scope="row"{{ col_class[loop.index0] | safe }}>{{ cell }}</td>
      {% else %}
      <td{{ col_class[loop.index0] | safe }}>{{ cell }}</td>
      {% endif %}
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
  {% endif %}
</table>
{%- endmacro -%}
